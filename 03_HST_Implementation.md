# 03_HST_Implementation — HST 実装指針（メタファー排除版）

**正本（Canonical）**: 日本語版。

本ドキュメントは、**HST の実装**に必要な定義とルールを、臓器・屠畜牛・寿司職人・熟成肉等のメタファーを排除し、Object・Morphism・境界面・In/Out の形式用語のみで記述する。概念の背景は [00_HST_Basic_Concepts.md](00_HST_Basic_Concepts.md) を参照。

---

## 1. 基本定義

### 1.1 命題

**あらゆる物・生命・システムは、境界面（In/Out）のみで定義・検証・予測可能である。**

### 1.2 形式用語

| 用語 | 定義 |
|------|------|
| **Object** | 機能単位。10 個以上の独立したモジュール。内部実装は観測不能 |
| **Morphism** | Object 間のインターフェース。型・契約・プロトコルで定義 |
| **境界面（Boundary）** | Object 間で交換される情報の面。In/Out のみが観測可能 |
| **In（Input）** | 境界面の上流側。投入される問い・データ・トリガー |
| **Out（Output）** | 境界面の下流側。返される回答・結果・応答 |

### 1.3 原則

- Object 同士は境界面で分離され、**境界面上の情報のみが交換される**
- 内部実装は観測不能（抽象化）である
- 生データは境界面を越える前に変換される

---

## 2. システム構成

### 2.1 レイヤー分離

| 領域 | 役割 | システム対応 |
|------|------|-------------|
| **系外部** | 入力の前処理。分類・検証・フォーマット変換 | フロントエンド・API 層 |
| **系内部** | 処理済みデータのみ受け取る。永続化・貯蔵 | データベース・バックエンド |

**原則**: 系内部の責務を系外部に、系外部の責務を系内部に配置することは不可。どちらの方向でもシステム破壊に至る。

### 2.2 責務違反パターン

| 違反 | 例 | 結果 |
|------|-----|------|
| 系内部の責務を系外部に | UI で複雑な集計・結合ロジック | パフォーマンス崩壊、一貫性破綻 |
| 系外部の責務を系内部に | DB 内で入力検証・フォーマット変換 | システム破壊 |

### 2.3 軽い処理の組み合わせ

- 各段階を**軽い処理**に分解する
- 前処理を境界面を越える前に完結させる
- モノリシック設計を避け、10+ の独立 Object の組み合わせとする

---

## 3. 開発の還元

### 3.1 Object と Morphism への還元

| 従来の開発 | HST における開発 |
|-----------|------------------|
| コードを書く | Object の定義と Morphism の設計 |
| SQL を直接書く | 型による境界面の記述（例: Drizzle） |
| Docker で環境を固める | 境界面での実行（エッジ）。コンテナは不要 |
| モノリシック | 10+ Object の組み合わせ。各 Object は Self-contained |

### 3.2 エンジニアの役割

- ランドスケープの理解
- オントロジーによる階層関係の整理
- トポロジーの説明可能性（＝再現可能性＝拡張性）
- 境界面への情報の記入
- Object 間の Morphism の正しさの保証
- 適切な 3rd party ブラックボックスの選択

### 3.3 テックスタック

境界面で分離されたテックスタックを用いない場合、CSS や Docker 等の依存により LLM の出力すら得られない。中央集権的バージョンコントロールから、エッジ端末が自律成長する局所系・広域系の構造へ移行する必要がある。

---

## 4. 事業の抽象化

### 4.1 ブラックボックス球

```
資本 (Input) → [ Object₁ ⟷ Object₂ ⟷ … ⟷ Objectₙ ] → 純利益 (Output)
                    ↑ Morphism で接続、順序を最適化
```

- 境界面・Object・Morphism を設計し、プロセッシング順序を最適化する
- 事業を資本 Input → 純利益 Output の単純な球に丸め込む

### 4.2 検証

| レベル | In | Out | 問い |
|--------|-----|-----|------|
| 外部から | 資本の投下 | ROIC | 返ってくるアウトプットは正しいか |
| 内部の系 | 資本投下したもの | 営業キャッシュフロー | Output されるか |
| 競争性 | — | 上記 Output | Competitive であるか |

**In/Out だけで内部構造を観察せずに検証できる。**

---

## 5. 認証と推論

### 5.1 Zero Knowledge Proof 型認証

- 球内部が目的に沿っているかは**境界面の In と Out で定義できる**
- 内部を開かずに、In/Out の整合性のみで証明
- 期待した Out が出ない場合、Input データが間違っている場合がほとんど

### 5.2 ブラックボックスの許容

- 系内部を研究するのではなく、ブラックボックスを許容する
- 境界面（Input/Output）のみに依存する
- 推論で結果を予測する

---

## 6. GAAS 標準スタックとの対応

| 領域 | HST における位置づけ |
|------|---------------------|
| SolidJS (Signals) | 境界面の振動。部分変更が全体に波及しない |
| Tailwind CSS v4 | 表面の記述。HTML 内で完結する境界面 |
| Drizzle ORM | 型による境界面。SQL を直接書かず、型で統治 |
| SQLite (LibSQL) | 永続化層。単一ファイルで完結。サーバーレス/エッジ |
| Bun | ビルド・実行。Docker 不要 |
| https:// (PWA) | 事象の地平線。全デバイスに URL ひとつで配信 |

---

## 7. 参照

- [00_HST_Basic_Concepts.md](00_HST_Basic_Concepts.md) — HST 基本概念（メタファー含む）
- [01_HST_IO_Specification.md](01_HST_IO_Specification.md) — I/O 仕様
- [02_HST_SCA_Definition.md](02_HST_SCA_Definition.md) — SCA 構成定義

---

## 更新履歴

| 日付 | 変更内容 |
|-----|----------|
| 2026-02-27 | 初版作成（メタファー排除、形式用語のみで実装指針を記述） |
